jittered_points = TRUE, quantile_lines = TRUE, scale = 0.9, alpha = 0.7,
vline_size = 1, vline_color = "red",
point_size = 0.4, point_alpha = 1,
position = position_raincloud(adjust_vlines = TRUE)
) + theme_er() + scale_x_continuous(limits = c(-5, 30)) + facet_grid(season~.)
ggplot(ftc_dat, aes(x = def1, y = site, fill = 0.5 - abs(0.5 - stat(ecdf)))) +
geom_density_ridges(
jittered_points = TRUE, quantile_lines = TRUE, scale = 0.9, alpha = 0.7,
vline_size = 1, vline_color = "red",
point_size = 0.4, point_alpha = 1,
position = position_raincloud(adjust_vlines = TRUE)
)
ggplot(ftc_dat, aes(x = depth_cm, y = site, fill = def1)) +
geom_raster(hjust = 0, vjust = 0)
ggplot(ftc_dat, aes(x = depth_cm, y = site, fill = def1)) +
geom_raster(hjust = 0, vjust = 0) + theme_er() + facet_grid(season~.)
cars <- ggplot(ftc_dat, aes(depth_cm, factor(site)))
cars + stat_bin2d(aes(fill= after_stat(count)), binwidth = c(3,1))
cars + stat_bin2d(aes(fill= after_stat(count)), binwidth = c(3,1)) + theme_er() + facet_grid(season~.)
# load data---------------------------------
#ghg_csv = read.csv("processed/ghg_ftc.csv")
ghg_csv2 = read.csv("processed/ghg_depth.csv")
ftc_dat = read.csv("processed/FTC_quant_inprocess.csv")
library(dplyr)
library(tidyr)
str(ghg_csv2)
str(ftc_dat)
levels(as.factor(ghg_csv2$trmt))
# ggplot set up-----------------------------------
theme_er <- function() {  # this for all the elements common across plots
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=2, fill = NA),
plot.title = element_text(hjust = 0.5, size = 14),
plot.subtitle = element_text(hjust = 0.5, size = 12, lineheight = 1.5),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 12, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
}
library(ggplot2)
library(soilpalettes)
library(soilDB)
library(aqp)
library(sharpshootR)
library(sp)
library(ggridges)
# gain in C ggplot----------------------------------------
ggplot(ghg_csv, aes(x=TRT, y=gain_ug_per_gOC, fill=DAY)) + geom_boxplot()
# gain in C ggplot----------------------------------------
ggplot(ghg_csv2, aes(x=TRT, y=gain_ug_per_gOC, fill=DAY)) + geom_boxplot()
# gain in C ggplot----------------------------------------
ggplot(ghg_csv2, aes(x=trmt, y=gain_ug_g_OC, fill=day)) + geom_boxplot()
# gain in C ggplot----------------------------------------
ggplot(ghg_csv2, aes(x=trmt, y=gain_ug_g_oc, fill=day)) + geom_boxplot()
ggplot(ghg_csv2, aes(x=site, y=gain_ug_g_oc, fill=day)) + geom_boxplot()
ggplot(ghg_csv2, aes(x=day, y=gain_ug_g_oc, fill=site)) + geom_boxplot()
ggplot(ghg_csv, aes(x=day, y=gain_ug_g_oc, fill=site)) + geom_boxplot()
#boxplots
ggplot(ftc_dat, aes(x = def1, y = depth_cm, fill = site)) + geom_boxplot() + theme_er() +
scale_fill_manual (values = soil_palette("gley", 2)) + facet_grid(season~.)
#dotplots failed
ggplot() + geom_dotplot(data = ftc_dat, aes(y = depth_m, x = Def1, color = site)) + theme_er() +
scale_color_manual (values = soil_palette("gley", 2)) + facet_wrap(season~.)
#dotplots failed
ggplot() + geom_dotplot(data = ftc_dat, aes(y = depth_m, x = def1, color = site)) + theme_er() +
scale_color_manual (values = soil_palette("gley", 2)) + facet_wrap(season~.)
ggplot(ftc_dat, aes(x=def1, y=depth_cm, fill=site))
#ridge and grid plots
ggplot(ftc_dat, aes(x = def1, y = depth_cm, color = season)) +
stat_bin2d( mapping = NULL, data = NULL, geom = "tile", position = "identity" + bins = 30 + binwidth = NULL + drop = TRUE)
ggplot(ftc_dat, aes(x = def1, y = site, fill = 0.5 - abs(0.5 - stat(ecdf)))) +
stat_density_ridges(geom = "density_ridges_gradient", calc_ecdf = TRUE) +
scale_fill_viridis_c(name = "Tail probablity", direction = -1) + theme_er() + facet_grid(season~.)
ggplot(ftc_dat, aes(x = def1, y = site, fill = 0.5 - abs(0.5 - stat(ecdf)))) +
stat_density_ridges(geom = "density_ridges_gradient", calc_ecdf = TRUE) +
scale_fill_viridis_c(name = "Tail probablity", direction = -1) + theme_er() + scale_x_continuous(limits = c(-5, 30)) + facet_grid(season~.)
ggplot(ftc_dat, aes(x = def1, y = site, fill = 0.5 - abs(0.5 - stat(ecdf)))) +
stat_density_ridges(geom = "density_ridges_gradient", calc_ecdf = TRUE) +
scale_fill_viridis_c(name = "Tail probablity", direction = -1) + theme_er() + scale_x_continuous(limits = c(-5, 30)) + facet_grid(season~.)
ggplot(ftc_dat, aes(x = depth_cm, y = site, fill = def1)) +
geom_raster(hjust = 0, vjust = 0) + theme_er() + facet_grid(season~.)
cars <- ggplot(ftc_dat, aes(depth_cm, factor(site)))
cars + stat_bin2d(aes(fill= after_stat(count)), binwidth = c(3,1)) + theme_er() + facet_grid(season~.)
ggplot(ftc_dat, aes(x = depth_cm, y = site, height = def1)) +
geom_density_ridges(stat = "identity") + theme_er() + facet_grid(season~.)
ghg_aov1 = aov(data = ghg_csv, gain_ug_per_gOC ~ Site)
ghg_aov1 = aov(data = ghg_csv2, gain_ug_g_oc ~ site)
summary(ghg_aov1)
ghg_aov2 = aov(data = ghg_csv2, gain_ug_g_oc ~ day)
summary(ghg_aov2)
ghg_aov3 = aov(data = ghg_csv2, gain_ug_g_oc ~ site*day)
summary(ghg_aov3)
ggplot(ghg_csv, aes(x=Site, y=ug_12C_g_soil, fill=DAY)) +
geom_boxplot() + theme_er() +
scale_fill_manual (values = soil_palette("redox", 4))
ggplot(ghg_csv2, aes(x=site, y=gain_ug_g_oc, fill=day)) +
geom_boxplot() + theme_er() +
scale_fill_manual (values = soil_palette("redox", 4))
ggplot(ghg_csv2, aes(x=site, y=gain_ug_g_oc, fill=day)) +
geom_boxplot() + theme_er() +
scale_fill_manual (values = soil_palette("redox", 4))
ggplot(ghg_csv2, aes(x = day, y = gain_ug_g_oc, color = day)) +
geom_dotplot() +
xlab("Day") +
ylab("CO2 AVG") +
ggtitle("12C")
# load data---------------------------------
#ghg_csv = read.csv("processed/ghg_ftc.csv")
ghg_csv2 = read.csv("processed/ghg_depth.csv")
ftc_dat = read.csv("processed/FTC_quant_inprocess.csv")
library(dplyr)
library(tidyr)
str(ghg_csv2)
str(ftc_dat)
levels(as.factor(ghg_csv2$trmt))
# ggplot set up-----------------------------------
theme_er <- function() {  # this for all the elements common across plots
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=2, fill = NA),
plot.title = element_text(hjust = 0.5, size = 14),
plot.subtitle = element_text(hjust = 0.5, size = 12, lineheight = 1.5),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 12, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
}
library(ggplot2)
library(soilpalettes)
library(soilDB)
library(aqp)
library(sharpshootR)
library(sp)
library(ggridges)
# bubble plot with depth on y axis
ftc_dat %>%
filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = depth_cm, x = site, size = def1, color = def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.3))+
scale_y_reverse()+
# scale_size_continuous()+
scale_color_gradient(low = "blue", high = "red")+
facet_grid(~season)
# bubble plot with depth on y axis
ftc_dat %>%
filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = depth_cm, x = site, size = def1, color = def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.3))+
scale_y_reverse()+
# scale_size_continuous()+
scale_color_gradient(low = "blue", high = "red")+
theme_er() +
facet_grid(~season)
# bubble plot with depth on y axis
ghg_csv2 %>%
#filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = mid, x = site, size = gain_ug_g_oc, color = gain_ug_g_oc))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.3))+
scale_y_reverse()+
# scale_size_continuous()+
scale_color_gradient(low = "blue", high = "red")+
theme_er() +
facet_grid(~trmt)
# bubble plot with depth on y axis
ghg_csv2 %>%
#filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = mid, x = site, size = gain_ug_g_oc, color = gain_ug_g_oc))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.3))+
scale_y_reverse()+
# scale_size_continuous()+
scale_color_gradient(low = "blue", high = "red")+
ggtitle("Respiration (ug per g OC)") +
theme_er() +
facet_grid(~trmt)
# bubble plot with depth on y axis
ghg_csv2 %>%
#filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = mid, x = site, size = gain_ug_g_oc, color = gain_ug_g_oc))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.4))+
scale_y_reverse()+
# scale_size_continuous()
scale_color_gradient(low = "blue", high = "red")+
ggtitle("Respiration (ug per g OC)") +
theme_er() +
facet_grid(~trmt)
# bubble plot with depth on y axis
ghg_csv2 %>%
#filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = mid, x = site, size = gain_ug_g_oc, color = gain_ug_g_oc))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()
scale_color_gradient(low = "blue", high = "red")+
ggtitle("Respiration (ug per g OC)") +
theme_er() +
facet_grid(~trmt)
# bubble plot with depth on y axis
ftc_dat %>%
filter(duration==24 & mag.vec==1.5) %>%
filter(depth_cm<70) %<%
ggplot(aes(y = depth_cm, x = site, size = def1, color = def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.3))+
scale_y_reverse()+
# scale_size_continuous()+
scale_color_gradient(low = "blue", high = "red")+
theme_er() +
facet_grid(~season)
# bubble plot with depth on y axis
ftc_dat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<70) %>%
ggplot(aes(y = depth_cm, x = site, size = def1, color = def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.3))+
scale_y_reverse()+
# scale_size_continuous()+
scale_color_gradient(low = "blue", high = "red")+
theme_er() +
facet_grid(~season)
# bubble plot with depth on y axis
ftc_dat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<70) %>%
ggplot(aes(y = depth_cm, x = site, size = def1, color = def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.3))+
scale_y_reverse()+
# scale_size_continuous()+
scale_color_gradient(low = "green", high = "yellow")+
theme_er() +
facet_grid(~season)
# bubble plot with depth on y axis
ftc_dat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<70) %>%
ggplot(aes(y = depth_cm, x = site, size = def1, color = def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.3))+
scale_y_reverse()+
# scale_size_continuous()+
scale_color_gradient(low = "blue", high = "yellow")+
theme_er() +
facet_grid(~season)
# bubble plot with depth on y axis
ghg_csv2 %>%
#filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = mid, x = site, size = gain_ug_g_oc, color = gain_ug_g_oc))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()
scale_color_gradient(low = "blue", high = "yellow")+
ggtitle("Respiration (ug per g OC)") +
theme_er() +
facet_grid(~trmt)
# bubble plot with depth on y axis
ftc_dat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<70) %>%
ggplot(aes(y = depth_cm, x = site, size = def1, color = def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.3))+
scale_y_reverse()+
# scale_size_continuous()+
scale_color_gradient(low = "blue", high = "red")+
ggtitle("Freeze Thaw Cycle Frequency") +
theme_er() +
facet_grid(~season)
# bubble plot with depth on y axis
ftc_dat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<70) %>%
ggplot(aes(y = depth_cm, x = site, size = def1, color = def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
scale_color_gradient(low = "blue", high = "red")+
ggtitle("Freeze Thaw Cycle Frequency") +
theme_er() +
facet_grid(~season)
# bubble plot with depth on y axis
ghg_csv2 %>%
#filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = mid, x = site, size = gain_ug_g_oc, color = gain_ug_g_oc))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse() +
ylim = (0, 70) +
# scale_size_continuous()
scale_color_gradient(low = "blue", high = "yellow")+
ggtitle("Respiration (ug per g OC)") +
theme_er() +
facet_grid(~trmt)
# bubble plot with depth on y axis
ghg_csv2 %>%
#filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = mid, x = site, size = gain_ug_g_oc, color = gain_ug_g_oc))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse(ylim = (0, 70)) +
# scale_size_continuous()
scale_color_gradient(low = "blue", high = "yellow")+
ggtitle("Respiration (ug per g OC)") +
theme_er() +
facet_grid(~trmt)
# bubble plot with depth on y axis
ghg_csv2 %>%
#filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = mid, x = site, size = gain_ug_g_oc, color = gain_ug_g_oc))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse(ylim = c(0, 70)) +
# scale_size_continuous()
scale_color_gradient(low = "blue", high = "yellow")+
ggtitle("Respiration (ug per g OC)") +
theme_er() +
facet_grid(~trmt)
# bubble plot with depth on y axis
ghg_csv2 %>%
#filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = mid, x = site, size = gain_ug_g_oc, color = gain_ug_g_oc))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse() +
ylim = c(0, 70) +
# scale_size_continuous()
scale_color_gradient(low = "blue", high = "yellow")+
ggtitle("Respiration (ug per g OC)") +
theme_er() +
facet_grid(~trmt)
# bubble plot with depth on y axis
ghg_csv2 %>%
filter(mid > 0) %>%
ggplot(aes(y = mid, x = site, size = gain_ug_g_oc, color = gain_ug_g_oc))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse() +
# scale_size_continuous()
scale_color_gradient(low = "blue", high = "yellow")+
ggtitle("Respiration (ug per g OC)") +
theme_er() +
facet_grid(~trmt)
# bubble plot with depth on y axis
ghg_csv2 %>%
filter(mid > 0) %>%
ggplot(aes(y = mid, x = site, size = gain_ug_g_oc, color = gain_ug_g_oc))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse() +
coord_cartesian(ylim = c(0,70)) +
# scale_size_continuous()
scale_color_gradient(low = "blue", high = "yellow")+
ggtitle("Respiration (ug per g OC)") +
theme_er() +
facet_grid(~trmt)
# bubble plot with depth on y axis
ghg_csv2 %>%
filter(mid > 0) %>%
ggplot(aes(y = mid, x = site, size = gain_ug_g_oc, color = gain_ug_g_oc))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse() +
coord_cartesian(ylim = c(70,0)) +
# scale_size_continuous()
scale_color_gradient(low = "blue", high = "yellow")+
ggtitle("Respiration (ug per g OC)") +
theme_er() +
facet_grid(~trmt)
ftc_fulldat = read.csv("processed/final_dat2.csv")
str(ftc_fulldat)
level(as.factor(ftc_fulldat$site)
level(as.factor(ftc_fulldat$site))
mutate(site, levels = c("BARR", "TOOL", "BONA", "HEAL"))
levels(as.factor(ftc_fulldat$site))
mutate(site, levels = c("BARR", "TOOL", "BONA", "HEAL"))
mutate(site = factor (site, levels = c("BARR", "TOOL", "BONA", "HEAL"))
mutate(site = factor (site, levels = c("BARR", "TOOL", "BONA", "HEAL")))
mutate(site = factor (site, levels = c("BARR", "TOOL", "BONA", "HEAL")))
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = depth_cm, x = site, size = def1, color = def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.3))+
scale_y_reverse()+
# scale_size_continuous()+
scale_color_gradient(low = "blue", high = "red")+
theme_er() +
facet_grid(~season)
str(ftc_fulldat)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = depth_cm, x = site, size = Def1, color = Def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.3))+
scale_y_reverse()+
# scale_size_continuous()+
scale_color_gradient(low = "blue", high = "red")+
theme_er() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = depth_cm, x = site, size = Def1, color = Def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
scale_color_gradient(low = "blue", high = "red")+
theme_er() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = depth_cm, x = site, size = Def1, color = Def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
ggtitle("Freeze Thaw Gradient Across Seasons")
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = depth_cm, x = site, size = Def1, color = Def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
ggtitle("Freeze Thaw Gradient Across Seasons") +
# scale_size_continuous()+
scale_color_gradient(low = "blue", high = "red")+
theme_er() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = depth_cm, x = site, size = Def1, color = Def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
ggtitle("Freeze Thaw Gradient Across Seasons") +
scale_size_continuous(0.5)+
scale_color_gradient(low = "blue", high = "red")+
theme_er() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = depth_cm, x = site, size = Def1, color = Def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
ggtitle("Freeze Thaw Gradient Across Seasons") +
scale_size_continuous(0.75)+
scale_color_gradient(low = "blue", high = "red")+
theme_er() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5) %>%
ggplot(aes(y = depth_cm, x = site, size = Def1, color = Def1))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
ggtitle("Freeze Thaw Gradient Across Seasons") +
scale_size_continuous(1) +
scale_color_gradient(low = "blue", high = "red")+
theme_er() +
facet_grid(~season)
# Load libraries-------------------------------
library(tidyverse)
library(reshape2)
# Load data------------------------------------
report = read.csv("processed/Lybrand Alaska Sept 2019 Report_Colorcoded.csv")
fticr_data = read.csv(FTICR_LONG)
fticr_data = read.csv("fticr_data.csv")
fticr_data = read.csv("processed/fticr_data.csv")
fticr_meta = read.csv("processed/fticr_meta.csv")
meta_hcoc  = read.csv("processed/fticr_meta_hcoc.csv")
report2 = read.csv("processed/Lybrand Alaska CHCl3 Sept 2019 Report_Colorcoded.csv")
fticr_report2 =
report %>%
filter(Mass>200 & Mass<900) %>%
filter(C13==0) %>%
filter(C>0)
# Load data------------------------------------
report = read.csv("processed/Lybrand Alaska Sept 2019 Report_Colorcoded.csv")
# Assemble reports------------------------------
fticr_report =
report %>%
# filter appropriate mass range
filter(Mass>200 & Mass<900) %>%
# remove isotopes
filter(C13==0) %>%
# remove peaks without C assignment
filter(C>0)
rlang::last_error()
