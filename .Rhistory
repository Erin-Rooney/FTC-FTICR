y = "depth, cm",
x = "",
color = "Freeze/Thaw Cycles")+
#legend.title = "Freeze/Thaw Cycles during Maximum Thaw",
#annotate("text", label = "perm", x = 1.5, y = 6, size = 4)+
#  annotate("rect", xmax = 0.5, xmin = 1.5, ymax = 5, ymin = 25,
#           fill = "red", alpha = 0.5, color = "black", size = 4)+
theme_er()
ftc_fulldat_subset2 %>%
filter(Def1 > 0) %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, color = as.character(Def1)))+
geom_point(position = position_jitter(width = 0.2), size = 4.5)+
geom_point(data = ftc_fulldat_subset2 %>% filter(Def1 == 0 &duration==24 & mag.vec==1.5 & depth_cm<100),
position = position_jitter(width = 0.2), size = 2, color = "black")+
scale_y_reverse()+
#annotate("segment", x = 0.7, xend = 1.3, y = 50, yend = 50, color = "pink", size= 2) +
annotate("segment", x = 0.7, xend = 1.3, y = 19, yend = 19, color = "red", alpha = 0.4, size= 1.5) +
#scale_color_gradient(low = "light blue", high = "brown")+
annotate("text", label = "organic soil\n(0-20 cm)", x = 1.4, y = 13, size = 4)+
annotate("text", label = "upper mineral\n(25-50 cm)", x = 1.4, y = 40, size = 4)+
annotate("text", label = "lower mineral\n(50-70 cm)", x = 1.4, y = 55, size = 4)+
annotate("text", label = "core 1 \n aggregates 1-2", x = 0.65, y = 37, size = 4)+
annotate("text", label = "core 2 \n aggregates 3-4", x = 0.63, y = 23, size = 4)+
annotate("text", label = "core 3 \n aggregates 5-6", x = 0.60, y = 55, size = 4)+
annotate(
geom = "curve", x = 0.68, y = 41, xend = 0.8, yend = 44,
curvature = 0.3, arrow = arrow(length = unit(2, "mm")))+
annotate(
geom = "curve", x = 0.72, y = 28, xend = 0.8, yend = 34,
curvature = 0.25, arrow = arrow(length = unit(2, "mm")))+
annotate(
geom = "curve", x = 0.64, y = 51, xend = 0.8, yend = 47,
curvature = -0.3, arrow = arrow(length = unit(2, "mm")))+
scale_color_manual(values = (PNWColors::pnw_palette("Bay", 2)))+
labs(
title = "Freeze/Thaw Soil Profile \n Toolik, Alaska \n ",
y = "depth, cm",
x = "",
color = "Freeze/Thaw Cycles")+
#legend.title = "Freeze/Thaw Cycles during Maximum Thaw",
#annotate("text", label = "perm", x = 1.5, y = 6, size = 4)+
#  annotate("rect", xmax = 0.5, xmin = 1.5, ymax = 5, ymin = 25,
#           fill = "red", alpha = 0.5, color = "black", size = 4)+
theme_er()
ftc_dat = read.csv("processed/FTC_quant_inprocess.csv")
ftc_fulldat = read.csv("processed/final_dat2.csv")
library(tidyverse)
ftc_fulldat = ftc_fulldat %>%
mutate(site = factor (site, levels = c("HEAL", "BONA", "BARR", "TOOL")),
site = recode (site, "HEAL" = "Healy",
"BONA" = "Caribou-poker",
"BARR" = "Barrow",
"TOOL" = "Toolik"))%>%
filter(!season == "activelayer" & !is.na(Def1)) %>%
mutate(season = factor(season, levels = c("spring", "summer", "fall", "winter")))
ftc_actdat = ftc_fulldat %>%
filter(season=="activelayer" & !is.na(Def1)) %>%
mutate(site = factor (site, levels = c("healy", "caribou-poker", "barrow", "toolik")))
ftc_dat = ftc_dat %>%
filter(!season == "activelayer") %>%
mutate(season = factor(season, levels = c("spring", "summer", "fall", "winter")))
# ggplot set up-----------------------------------
theme_er1 <- function() {  # this for all the elements common across plots
theme_bw() %+replace%
theme(legend.position = "bottom",
#legend.key=element_blank(),
#legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=2, fill = NA),
plot.title = element_text(hjust = 0.5, size = 14),
plot.subtitle = element_text(hjust = 0.5, size = 12, lineheight = 1.5),
axis.text = element_text(size = 12, color = "black"),
axis.text.x.bottom = element_text (vjust = 0.5, hjust=1, angle = 90),
axis.title = element_text(size = 12, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
}
theme_er <- function() {  # this for all the elements common across plots
theme_bw() %+replace%
theme(legend.position = "bottom",
#legend.key=element_blank(),
#legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=2, fill = NA),
plot.title = element_text(hjust = 0.5, size = 14),
plot.subtitle = element_text(hjust = 0.5, size = 12, lineheight = 1.5),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 12, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
}
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("segment", x = 0.7, xend = 1.3, y = 9, yend = 9, color = "pink", size= 2) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("segment", x = 3.75, xend = 4.25, y = 0, yend = 100, color = "pink", size= 2) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("rect", xmax = 4.25, xmin = 3.75, ymax = 100, ymin = 0,
fill = "gray55", alpha = 0.5, color = "gray55", size = 3) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("rect", xmax = 4.25, xmin = 3.75, ymax = 100, ymin = 0,
fill = "gray55", alpha = 0.5, color = "gray55", size = 0.5) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
annotate("rect", xmax = 4.25, xmin = 3.75, ymax = 100, ymin = 0,
fill = "gray55", alpha = 0.5, color = "gray55", size = 0.5) +
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("rect", xmax = 4.25, xmin = 3.75, ymax = 100, ymin = 0,
fill = "gray55", alpha = 0.9, color = "gray55", size = 0.5) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("rect", xmax = 4.25, xmin = 3.75, ymax = 100, ymin = 0,
fill = "gray55", alpha = 0.2, color = "gray55", size = 0.5) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("rect", xmax = 4.20, xmin = 3.8, ymax = 100, ymin = 0,
fill = "gray55", alpha = 0.2, color = "gray55", size = 0.5) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("rect", xmax = 4.15, xmin = 3.95, ymax = 100, ymin = 0,
fill = "gray55", alpha = 0.2, color = "gray55", size = 0.5) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("rect", xmax = 5, xmin = 3, ymax = 100, ymin = 0,
fill = "gray55", alpha = 0.2, color = "gray55", size = 0.5) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("rect", xmax = 4.5, xmin = 3.4, ymax = 100, ymin = 0,
fill = "gray55", alpha = 0.2, color = "gray55", size = 0.5) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("rect", xmax = 4.45, xmin = 3.35, ymax = 100, ymin = 0,
fill = "gray55", alpha = 0.2, color = "gray55", size = 0.5) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("rect", xmax = 4.45, xmin = 3.45, ymax = 100, ymin = 0,
fill = "gray55", alpha = 0.2, color = "gray55", size = 0.5) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("rect", xmax = 4.45, xmin = 3.55, ymax = 100, ymin = 0,
fill = "gray55", alpha = 0.2, color = "gray55", size = 0.5) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("rect", xmax = 4.45, xmin = 3.55, ymax = 100, ymin = -0.5,
fill = "gray55", alpha = 0.2, color = "gray55", size = 0.5) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("rect", xmax = 4.45, xmin = 3.55, ymax = 100, ymin = -0.5,
fill = "gray55", alpha = 0.1, color = "gray55", size = 0.5) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
ftc_fulldat %>%
filter(duration==24 & mag.vec==1.5 & depth_cm<100) %>%
ggplot(aes(y = depth_cm, x = site, size = as.character(Def1), color = as.character(Def1)))+
#geom_jitter()+
geom_point(position = position_jitter(width = 0.2))+
scale_y_reverse()+
# scale_size_continuous()+
# scale_color_gradient(low = "blue", high = "pink")+
scale_color_manual(values = (PNWColors::pnw_palette("Bay",7)))+
annotate("rect", xmax = 4.45, xmin = 3.55, ymax = 100, ymin = -0.5,
fill = "yellow", alpha = 0.1, color = "gray55", size = 0.5) +
labs(y = "depth, cm", x = "", color = "Freeze/Thaw Cycles", size = "Freeze/Thaw Cycles")+
#ggtitle("Freeze Thaw Cycle Frequency") +
theme_er1() +
facet_grid(~season)
library(Rmisc)
library(dplyr)
library(ggplot2)
library(ggforce)
library(ggrepel)
library(ggmap)
library(usmap)
library(PNWColors)
library(soilpalettes)
theme_er <- function() {  # this for all the elements common across plots
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=2, fill = NA),
plot.title = element_text(hjust = 0.5, size = 14),
plot.subtitle = element_text(hjust = 0.5, size = 12, lineheight = 1.5),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 12, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
}
#FTC Quantification dataset
FTC_dat = readRDS("processed/final_dat.RData")
#SOMMOS site-level data (latitude and longitude)
site_dat = read.csv("processed/SOMMOS_Site_11-25-19.csv")
#Subset permafrost sites only
permafrost_sites = subset(site_dat, site == "HEAL" | site == "BARR" | site == "BONA" | site == "TOOL")
dim(permafrost_sites) #should by 4 x 262
#Merge with FTC_dat
FTC_site = FTC_dat %>% right_join(permafrost_sites, by=c("site"))
head(FTC_site)
#Relevant data
plot_dat = subset(FTC_site, mag.vec == 1.5)
plot_dat=FTC_site[,c("longitude.dec_deg","latitude.dec_deg","site","Def1","season","core","depth_pos","year")]
#Relevant data
plot_dat = subset(FTC_site, mag.vec == 1.5)
plot_dat=FTC_site[,c("longitude.dec_deg","latitude.dec_deg","site","Def1","season","core","depth_pos","year")]
#Here can calculate what you want to average over (in this example, average over everything but site)
FTC_example = summarySE(plot_dat, measurevar = "Def1", groupvars = c("longitude.dec_deg", "latitude.dec_deg","site"), na.rm=TRUE)
colnames(FTC_example)=c("lon","lat","site","N","Def1","sd","se","ci")
plot_dat_transformed <- usmap_transform(FTC_example)
#This is giving a warning related to the projection, because checking the projection used in the function gives this warning:
usmap_crs()
View(plot_dat_transformed)
View(FTC_example)
library(Rmisc)
library(dplyr)
library(ggplot2)
library(ggforce)
library(ggrepel)
library(ggmap)
library(usmap)
library(PNWColors)
library(soilpalettes)
theme_er <- function() {  # this for all the elements common across plots
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=2, fill = NA),
plot.title = element_text(hjust = 0.5, size = 14),
plot.subtitle = element_text(hjust = 0.5, size = 12, lineheight = 1.5),
axis.text = element_text(size = 12, color = "black"),
axis.title = element_text(size = 12, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
}
#FTC Quantification dataset
FTC_dat = readRDS("processed/final_dat.RData")
#SOMMOS site-level data (latitude and longitude)
site_dat = read.csv("processed/SOMMOS_Site_11-25-19.csv")
#Subset permafrost sites only
permafrost_sites = subset(site_dat, site == "HEAL" | site == "BARR" | site == "BONA" | site == "TOOL")
dim(permafrost_sites) #should by 4 x 262
#Merge with FTC_dat
FTC_site = FTC_dat %>% right_join(permafrost_sites, by=c("site"))
head(FTC_site)
#Relevant data
plot_dat = subset(FTC_site, mag.vec == 1.5)
plot_dat=FTC_site[,c("longitude.dec_deg","latitude.dec_deg","site","Def1","season","core","depth_pos","year")]
#Relevant data
plot_dat = subset(FTC_site, mag.vec == 1.5)
plot_dat=FTC_site[,c("longitude.dec_deg","latitude.dec_deg","site","Def1","season","core","depth_pos","year")]
#Here can calculate what you want to average over (in this example, average over everything but site)
FTC_example = summarySE(plot_dat, groupvars = c("longitude.dec_deg", "latitude.dec_deg","site"), na.rm=TRUE)
colnames(FTC_example)=c("lon","lat","site","N","Def1","sd","se","ci")
#Here can calculate what you want to average over (in this example, average over everything but site)
FTC_example = summarySE(plot_dat, groupvars = c("longitude.dec_deg", "latitude.dec_deg","site"), na.rm=TRUE)
colnames(FTC_example)=c("lon","lat","site","N","Def1","sd","se","ci")
colnames(FTC_example)=c("lon","lat","site","N","Def1","sd","se","ci")
#Here can calculate what you want to average over (in this example, average over everything but site)
FTC_example = summarySE(plot_dat, measurevar = "Def1", groupvars = c("longitude.dec_deg", "latitude.dec_deg","site"), na.rm=TRUE)
colnames(FTC_example)=c("lon","lat","site","N","Def1","sd","se","ci")
plot_dat_transformed <- usmap_transform(FTC_example)
#This is giving a warning related to the projection, because checking the projection used in the function gives this warning:
usmap_crs()
#This is giving a warning related to the projection, because checking the projection used in the function gives this warning:
usmap_crs()
plot_usmap(include=c("AK")) +
geom_point(aes(x=lon.1, y=lat.1, fill=N), pch=21, data=plot_dat_transformed, size=3, color="black", show.legend=TRUE) +
geom_label_repel(aes(x=lon.1, y=lat.1, label=site), data=plot_dat_transformed, size=4.5, point.padding = 0.2) +
labs(fill="Freeze-thaw cycles (#)") +
scale_fill_viridis_c(option="viridis", direction=-1, guide = guide_colourbar
(barwidth=10, barheight=1, direction = "horizontal",
reverse = FALSE, title.position="top", ticks=FALSE, label=TRUE)) +
theme(legend.position=c(0.1,-0.3),
plot.margin = unit(c(2,2,2,2), "cm"),
legend.title = element_text(size=12, color="black"),
legend.text = element_text(size=10, color="black"))
plot_usmap(include=c("AK")) +
geom_point(aes(x=lon.1, y=lat.1, fill=N), pch=21, data=plot_dat_transformed, size=4, color="black", show.legend=TRUE) +
geom_label_repel(aes(x=lon.1, y=lat.1, label=site), data=plot_dat_transformed, size=4.5, point.padding = 0.2) +
labs(fill="Freeze-thaw cycles (#)") +
scale_fill_gradientn(colors = rev(soil_palette("redox", 4)),
guide = guide_colourbar(barwidth=10, barheight=1, direction = "horizontal",
reverse = FALSE, title.position="top", ticks=FALSE, label=TRUE)) +
theme(legend.position=c(0.1,-0.3),
plot.margin = unit(c(2,2,2,2), "cm"),
legend.title = element_text(size=12, color="black"),
legend.text = element_text(size=10, color="black"))
summary(FTC_example, Def1)
sum(FTC_example, Def1)
sum(FTC_example$Def1)
